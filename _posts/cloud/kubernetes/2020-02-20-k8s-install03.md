---
title: k8s ê¸°ë³¸-1.ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì¹˜(3)
excerpt: Minikube ì„¤ì¹˜í•˜ê¸° 
date: 2020-02-20 02:00:00 +0800
last_modified_at: 2020-08-17 00:00:00 +0800
header:
  teaser: https://live.staticflickr.com/65535/50118270208_9de7c7ed9d_c.jpg
  overlay_image: https://live.staticflickr.com/65535/50118270208_9de7c7ed9d_c.jpg
  overlay_filter: 0.5
  og_image: https://live.staticflickr.com/65535/50118270208_9de7c7ed9d_c.jpg
  caption: "Photo credit: [**Flickr***](https://live.staticflickr.com)"
categories: kubernetes
---

### ê°œìš”

GCP í™˜ê²½ì—ì„œ Minikube ì„¤ì¹˜

### gcloud cli ë‹¤ìš´ë¡œë“œ

[gcloud CLI ë‹¤ìš´ë¡œë“œ](https://cloud.google.com/sdk/docs#install_the_latest_cloud_tools_version_cloudsdk_current_version)


### ì¤‘ì²© ê°€ìƒí™” ê°€ëŠ¥ VM ìƒì„±

VM ìƒì„±ì€ ì¤‘ì²© ê°€ìƒí™”ê°€ ê°€ëŠ¥í•œ VMì´ í•„ìš”í•˜ë¯€ë¡œ ì•„ë˜ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ìƒì„±

[ì°¸ê³ : VM ì¸ìŠ¤í„´ìŠ¤ìš© ì¤‘ì²© ê°€ìƒí™” ì‚¬ìš© ì„¤ì •](https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances#starting_a_nested_vm) <br>

#### ë””ìŠ¤í¬ ìƒì„± 

```sh 
gcloud compute disks create disk1 --image-project centos-cloud --image-family centos-7 --zone us-central1-b
```

#### ë””ìŠ¤í¬ ê¸°ë°˜ìœ¼ë¡œ ì´ë¯¸ì§€ ìƒì„±

```sh
gcloud compute images create nested-vm-image \
  --source-disk disk1 --source-disk-zone us-central1-b \
  --licenses "https://compute.googleapis.com/compute/v1/projects/vm-options/global/licenses/enable-vmx"
```

#### ì´ë¯¸ì§€ë¡œ VM ìƒì„±

```sh
gcloud compute instances create gcp-minikube-vm --zone us-central1-b \
              --min-cpu-platform "Intel Haswell" \
              --image nested-vm-image
```

#### VM ì ‘ì†
```sh 
gcloud compute ssh gcp-minikube-vm 
```

#### Dependency ì„¤ì •

[ì°¸ê³ : Dependency ì„¤ì •](http://tonychungblogtest.blogspot.com/2017/10/to-remove-virtualbox-sudo-dpkg-list.html) <br>

í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜

```sh 
sudo yum update -y
sudo yum install wget
sudo yum install gcc make patch  dkms qt libgomp
sudo yum install kernel-headers kernel-devel fontforge binutils glibc-headers glibc-devel
```

#### ì¬ë¶€íŒ…

```sh 
sudo reboot
```

#### ì½˜ì†” ì¬ì ‘ì† í›„ì— ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒˆë¡œìš´ ì»¤ë„ë¡œ ê¸°ë™ 

```sh 
export KERN_DIR=/usr/src/kernels/`uname -r`
```

### VirtualBox ì„¤ì¹˜

#### Repository ì„¤ì • 

```sh 
# yum repository ê²½ë¡œ ë“±ë¡ì„ ìœ„í•´ ë””ë ‰í† ë¦¬ ì´ë™
[*** ]$ cd /etc/yum.repos.d/

# yumìœ¼ë¡œ virtualbox ì„¤ì¹˜ë¥¼ ìœ„í•´ virtualbox repoë¥¼ ë“±ë¡
[*** yum.repos.d]$ sudo wget http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo

#virtualbox ì„¤ì¹˜
[*** yum.repos.d]$ sudo yum install VirtualBox-6.1
```

#### Kubectl ì„¤ì¹˜

```sh 
[*** yum.repos.d]$ sudo curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl
[*** yum.repos.d]$ sudo chmod +x ./kubectl
[*** yum.repos.d]$ sudo mv ./kubectl /usr/local/bin/kubectl

#kubectl ë²„ì „ í™•ì¸ 
[*** yum.repos.d]$ kubectl version --client
```

### Minikube ì„¤ì¹˜

#### Minikube ë‹¤ìš´ë¡œë“œ 
```sh 
[*** yum.repos.d]$ sudo curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64   && sudo chmod +x minikube
[*** yum.repos.d]$ sudo mkdir -p /usr/local/bin/
[*** yum.repos.d]$ sudo install minikube /usr/local/bin/
```

#### Minikube ì‹œì‘

```sh 
minikube start --driver=virtualbox
```

#### ê²°ê³¼ í™”ë©´

```sh 
[*** yum.repos.d]$ minikube start
ğŸ˜„  minikube v1.7.3 on Centos 7.7.1908
âœ¨  Automatically selected the virtualbox driver
ğŸ’¿  Downloading VM boot image ...
    > minikube-v1.7.3.iso.sha256: 65 B / 65 B [--------------] 100.00% ? p/s 0s
    > minikube-v1.7.3.iso: 167.39 MiB / 167.39 MiB [] 100.00% 163.22 MiB p/s 2s
ğŸ”¥  Creating virtualbox VM (CPUs=2, Memory=2000MB, Disk=20000MB) ...
ğŸ³  Preparing Kubernetes v1.17.3 on Docker 19.03.6 ...
ğŸ’¾  Downloading kubelet v1.17.3
ğŸ’¾  Downloading kubeadm v1.17.3
ğŸ’¾  Downloading kubectl v1.17.3
ğŸš€  Launching Kubernetes ...
ğŸŒŸ  Enabling addons: default-storageclass, storage-provisioner
âŒ›  Waiting for cluster to come online ...
ğŸ„  Done! kubectl is now configured to use "minikube"
```

#### ë™ì‘ í™•ì¸ 

```sh 
kubectl get nodes
```
